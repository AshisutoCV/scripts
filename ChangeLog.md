# Changelog
## [VER=20191227a] - 2019/12/27

### 変更
#### getlog.sh
* TZの扱いを修正。サーバのTZに依存せず処理可能。
* swarm版のコンテナログを収集
* その他微修正

--------------------------------------------------------------
## [VER=20191218c] - 2019/12/18

#### shield-setup.sh
* 19.12(dev)のdeployが失敗する問題に対応。（LOGFILEパスの修正：再）

#### shield-start.sh
* 19.12(dev)のdeployが失敗する問題に対応。（LOGFILEパスの修正：再）

--------------------------------------------------------------

## [VER=20191218b] - 2019/12/18

#### shield-setup.sh
* 19.12(dev)のdeployが失敗する問題に対応。（typo）

#### shield-update.sh
* 引数利用時に、再実行コマンドの表示として引数を明示するように修正

--------------------------------------------------------------

## [VER=20191218a] - 2019/12/18

### 変更
#### shield-update.sh
* Devが利用出来ない問題を修正

#### shield-setup.sh
* 19.12(dev)のdeployが失敗する問題に対応。（LOGFILEパスの修正）

--------------------------------------------------------------

## [VER=20191216a] - 2019/12/16

### 変更
#### delete-all.sh
* 削除対象ディレクトリを拡張

--------------------------------------------------------------

## [VER=20191213a] - 2019/12/13

### 変更
#### shield-setup.sh
* 初回LOGINTOKEの取得前にスリープを設定

--------------------------------------------------------------

## [VER=20191212a] - 2019/12/12

### 変更
#### delete-all.sh
* 19.11からのrancher-storeパス変更にともなう対応

--------------------------------------------------------------

## [VER=20191211a] - 2019/12/11

### 変更
#### shield-setup.sh
* ファームサービスの標準配置をsystem宇コンポーネント側に変更。
* --delete-allオプションでnoを入れても処理が進む問題を修正。

--------------------------------------------------------------

## [VER=20191206a] - 2019/12/06

### 変更
#### shield-stop.sh
* 19.11でのdelete-shield.sh変更に対応。

### 変更
#### shield-setup.sh
* オールインワンインストールの選択をAdvance側へ。

--------------------------------------------------------------

## [VER=20191203a] - 2019/12/03

### 変更
#### shield-update.sh
* configure-sysctl-values.sh の差分実行コマンドミス修正。

--------------------------------------------------------------

## [VER=20191119a] - 2019/11/19

### 変更
#### proxy-cent.py
* yumのproxy指定修正。

--------------------------------------------------------------

## [VER=20191106a] - 2019/11/6

### 変更
#### shield-setup.sh
* DevおよびStaging選択時のブランチ指定を修正。

#### shield-update.sh
* DevおよびStaging選択時のブランチ指定を修正。

--------------------------------------------------------------

## [VER=20191105a] - 2019/11/5

### 変更
#### shield-nodes.sh
* command.txtの書き換えに失敗していた問題を修正。

--------------------------------------------------------------

## [VER=20191101b] - 2019/11/1

### 変更
#### shield-setup.sh
* TZ対応の不足対応。

#### shield-start.sh
* TZ対応の不足対応。

--------------------------------------------------------------


## [VER=20191101a] - 2019/11/1

### 変更
#### shield-setup.sh
* antiafinityの設定処理が正しくおこなわれていない問題を修正。

--------------------------------------------------------------

## [VER=20191031b] - 2019/10/31

### 追加
#### shield-sup.sh
* 新規作成。

### 変更
#### getlog.sh
* swarm版にも対応。

#### shield-setup.sh
* UbuntuにおいてUniverseリポジトリの追加と、libssl1.1の問題に対処しました。(BugFix)
* shield-sup.sh および getlog.sh を取得するように設定。(sup/ 配下に配置。)

--------------------------------------------------------------

## [VER=20191031a] - 2019/10/31

### 変更
#### getlog.sh
* デフォルトでのTZ指定を廃止。および収集単位を10000レコードに。TZ指定した場合は100レコード単位にスイッチする。

#### shield-setup.sh
* deploy-shield.sh内のTZ指定部分のメーカーbugをケアするように対応
* ses_limit_flgが正しく指定できない問題を修正。
* UbuntuにおいてUniverseリポジトリの追加と、libssl1.1の問題に対処しました。

#### shield-start.sh
* deploy-shield.sh内のTZ指定部分のメーカーbugをケアするように対応

--------------------------------------------------------------

## [VER=20191018a] - 2019/10/18

### 変更
#### shield-setup.sh
* 他ノードでの実行コマンド表示で不要なコマンド(setup-node.sh)が表示されていたのを削除。

--------------------------------------------------------------

## [VER=20191016a] - 2019/10/16

### 変更
#### shield-update.sh
* chekc_sysctlが未呼び出しである問題を修正

--------------------------------------------------------------

## [VER=20191010a] - 2019/10/10

### 変更
#### shield-update.sh
* yamlファイルの比較で差分がまったく無い場合にエラーになる問題を修正。

--------------------------------------------------------------

## [VER=20191008a] - 2019/10/08

### 変更
#### shield-restore.sh
* 自動リストア抑止が行われるようになったbuild576以降のconsul_backupに対応。

#### shield-update.sh
* configure-sysctl-values.shの差分があった場合、他のノードでも実行するように表示。

--------------------------------------------------------------

## [VER=20191007b] - 2019/10/07

### 変更
#### shield-update.sh
* 差分確認後の再実行時、updateを実行してよいかどうかの確認を行うように修正。

--------------------------------------------------------------

## [VER=20191007a] - 2019/10/07

### 変更
#### shield-update.sh
* shield-setups.shの更新箇所にバグあり。修正対応。
* logsディレクトリが存在しない場合に作成するように修正。

#### shield-start.sh
* logsディレクトリが存在しない場合に作成するように修正。

#### shield-stop.sh
* logsディレクトリが存在しない場合に作成するように修正。

#### shield-nodes.sh
* logsディレクトリが存在しない場合に作成するように修正。

--------------------------------------------------------------

## [VER=20191003a] - 2019/10/03

### 追加
#### shield-update.sh
* yamlファイル差分のチェックを事前実施して警告。後にshieldsetup.shを呼び出すように実装。

### 変更
#### shield-setup.sh
* bonding対応
* System component が3台構成ならantiafinity:hardを有効化
* updateを別スクリプト(shield-update.sh)からのトリガーを想定するように修正
* Dockerバージョン固定の修正
* logファイルをlogディレクトリに集約

#### shield-start.sh
* logファイルをlogディレクトリに集約

#### shield-stop.sh
* logファイルをlogディレクトリに集約
* 以前のバージョンにおける不正な common の削除を判定により削除可能なよう修正(恒久対策完了)

#### shield-nodes.sh
* logファイルをlogディレクトリに集約
* Rancher Agent追加用コマンド(command.txt)を実行時に随時更新するように変更。

#### delete-all.sh
* CentOSにおいて、rancher-store ディレクトリが削除されない問題に対応
* 各種追加スクリプトやyamlなどの削除を追加

#### getlog.sh
* 複数ログ対応
* 10000件以上の出力に対応
* TZ指定による時刻変換に対応
* ファイルへの出力対応

### 移動
#### sup へ
* getlog.sh

--------------------------------------------------------------

## [VER=20190920a] - 2019/09/20

### 追加
#### shield-restore.sh
* 特定顧客向けにリストアスクリプトを作成

--------------------------------------------------------------

## [VER=20190919b] - 2019/09/19
### 変更
#### shield-stop.sh
* 以前のバージョンにおける不正な common の削除を網羅的に実施。存在しない場合のエラーを許容。(暫定対応)

--------------------------------------------------------------

## [VER=20190919a] - 2019/09/19
### 変更
#### shield-setup.sh
* updateにおいて、moveto_projectを行うように修正。

--------------------------------------------------------------

## [VER=20190823a] - 2019/09/18
### 変更
#### shield-stop.sh
* バージョン番号付与開始? (作成当時の日付をバージョンとして設定)

--------------------------------------------------------------

## [VER=20190913a] - 2019/09/13
### 変更
#### shield-setup.sh
* バージョン番号付与開始
* クラスタ作成時にlocalClusterAuthEndpointを追加。（他C/Mにkubectlを入れて代替オペ可能)
* NWをcalicoからflannelに変更
* configure-sysctl-values.shの実行タイミング変更
* clean-rancher-agent.shおよびdelete-all.shをDLしておくように設定

--------------------------------------------------------------

## [VER=20190911a] - 2019/09/11
### 変更
#### shield-start.sh
* バージョン番号付与開始
* deploy-shield.shにおけるSHIELD_REPO変数に対応。(19.09から。ビルドは564以降)
* common 対応

--------------------------------------------------------------

## [VER=20190910a] - 2019/09/10
### 追加
#### shield-nodes.sh
* バージョン番号付与開始?

--------------------------------------------------------------

## [VER=] - 2019/09/06
### 変更
#### shield-setup.sh
* deploy-shield.shにおけるSHIELD_REPO変数に対応。(19.09から。ビルドは564以降)
* NWをcalicoからflannelに変更しようとしたができておらず。
* common 対応

